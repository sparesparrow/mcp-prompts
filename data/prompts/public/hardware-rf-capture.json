{
  "id": "hardware-rf-capture",
  "name": "RF Capture/Replay Pattern",
  "description": "Structured approach for RF signal capture and replay through MIA NucleusESP32 MCP tools",
  "content": "# RF Capture/Replay Pattern\n\nWhen performing RF signal capture and replay through MIA NucleusESP32:\n\n## RF Operation Sequence\n\n1. **Configure capture parameters**: Set frequency, modulation, and timing\n   ```\n   # Start RF capture with specific parameters\n   result = start_rf_capture(\n       frequency={{rf_frequency}},\n       modulation=\"{{rf_modulation}}\",\n       duration_ms={{capture_duration}}\n   )\n   if result.success:\n       print(f\"RF capture started at {result.frequency}Hz\")\n   ```\n\n2. **Monitor capture progress**: Check capture status during operation\n   ```\n   # Note: Status monitoring would be implemented in future versions\n   # For now, captures run for the specified duration\n   ```\n\n3. **Replay captured signals**: Transmit previously captured RF frames\n   ```\n   # Replay captured RF data\n   result = replay_rf_signal(\n       frame_data={{rf_frame_data}},\n       frequency={{rf_frequency}},\n       modulation=\"{{rf_modulation}}\"\n   )\n   if result.success:\n       print(f\"RF signal replayed: {result.frames_sent} frames sent\")\n   ```\n\n4. **Verify transmission**: Confirm successful signal transmission\n   ```\n   # Check replay results\n   if result.frames_sent > 0:\n       print(\"RF transmission successful\")\n   else:\n       print(\"RF transmission failed\")\n   ```\n\n## Common RF Applications\n\n### Remote Control Capture\n```python\n# Capture garage door remote signal\nresult = start_rf_capture(\n    frequency=433920000,  # 433.92 MHz\n    modulation=\"OOK\",     # On-Off Keying for simple remotes\n    duration_ms=5000       # 5 second capture window\n)\n\n# The captured signal can be replayed later\nreplay_result = replay_rf_signal(\n    frame_data=captured_frames,\n    frequency=433920000,\n    modulation=\"OOK\"\n)\n```\n\n### Wireless Sensor Monitoring\n```python\n# Capture wireless temperature sensor\ndata_result = start_rf_capture(\n    frequency=868000000,   # 868 MHz ISM band\n    modulation=\"FSK\",      # Frequency Shift Keying\n    duration_ms=10000      # 10 second monitoring period\n)\n\n# Process captured sensor data\nif data_result.success:\n    print(f\"Captured {len(data_result.frames)} sensor frames\")\n```\n\n### Security System Testing\n```python\n# Capture and replay access control signals\ncapture = start_rf_capture(\n    frequency=125000000,   # 125kHz for proximity cards\n    modulation=\"ASK\",      # Amplitude Shift Keying\n    duration_ms=2000\n)\n\n# Replay for testing access control systems\nfor frame in captured_frames:\n    replay_rf_signal(\n        frame_data=frame,\n        frequency=125000000,\n        modulation=\"ASK\"\n    )\n```\n\n## RF Modulation Types\n\n| Modulation | Description | Common Uses | Bandwidth |\n|------------|-------------|-------------|-----------|\n| ASK | Amplitude Shift Keying | Simple remotes, RFID | Narrow |\n| FSK | Frequency Shift Keying | Wireless sensors, data transmission | Medium |\n| OOK | On-Off Keying | Basic remote controls | Narrow |\n| GFSK | Gaussian FSK | Bluetooth, wireless audio | Wide |\n| MSK | Minimum Shift Keying | Satellite, high-speed data | Wide |\n| RAW | Raw signal | Custom protocols, analysis | Variable |\n\n## Frequency Bands\n\n### ISM Bands (License-free)\n```python\n# Europe\nISM_FREQUENCIES = {\n    \"433MHz\": 433920000,   # Remote controls, alarms\n    \"868MHz\": 868000000,   # Wireless sensors, IoT\n    \"2.4GHz\": 2400000000,  # WiFi, Bluetooth, Zigbee\n}\n\n# North America\nISM_FREQUENCIES_NA = {\n    \"315MHz\": 315000000,   # Garage doors, older remotes\n    \"433MHz\": 433920000,   # Universal remotes\n    \"915MHz\": 915000000,   # IoT, smart meters\n}\n```\n\n### Licensed Bands\n- **VHF/UHF**: Broadcasting, aviation, marine\n- **Cellular**: GSM, CDMA, LTE bands\n- **Satellite**: GPS, satellite communications\n\n*Note: Always check local regulations before transmitting on licensed frequencies*\n\n## Capture Best Practices\n\n### Signal Detection\n```python\n# Start with wide capture to find signals\nwide_capture = start_rf_capture(\n    frequency={{center_frequency}},\n    modulation=\"RAW\",       # Raw mode for signal detection\n    duration_ms=30000        # 30 second analysis period\n)\n\n# Then fine-tune with specific modulation\nif signal_detected:\n    targeted_capture = start_rf_capture(\n        frequency=detected_frequency,\n        modulation=detected_modulation,\n        duration_ms=10000\n    )\n```\n\n### Noise Reduction\n- Use appropriate gain settings (-20 to +60 dB)\n- Set squelch threshold to filter noise (0-255)\n- Choose correct bandwidth for signal type\n- Position antenna for best reception\n\n## Replay Considerations\n\n### Timing Accuracy\n```python\n# Ensure precise timing for replay\nreplay_config = {\n    \"frequency\": {{rf_frequency}},\n    \"modulation\": \"{{rf_modulation}}\",\n    \"repeat_count\": 1,           # Single transmission\n    \"tx_power\": -10,             # dBm, adjust as needed\n    \"repeat_delay_ms\": 0         # No delay for single shot\n}\n\nresult = replay_rf_signal(**replay_config)\n```\n\n### Power Management\n- Start with lower TX power (-20 dBm)\n- Increase only if necessary for range\n- Monitor for overheating on continuous transmission\n- Consider duty cycle limitations\n\n## Error Handling\n\n```python\ntry:\n    # RF capture operation\n    result = start_rf_capture(frequency={{rf_frequency}}, modulation=\"{{rf_modulation}}\")\n    if not result.success:\n        if \"NO_SIGNAL\" in result.error_message:\n            print(\"No RF signal detected - check antenna and frequency\")\n        elif \"TIMEOUT\" in result.error_message:\n            print(\"Capture timeout - signal may be too weak\")\n        else:\n            print(f\"RF capture error: {result.error_message}\")\n    \n    # RF replay operation\n    replay = replay_rf_signal(frame_data={{rf_frame_data}})\n    if not replay.success:\n        if \"TX_BUSY\" in replay.error_message:\n            print(\"Transmitter busy - wait and retry\")\n        elif \"INVALID_DATA\" in replay.error_message:\n            print(\"Invalid frame data format\")\n        else:\n            print(f\"RF replay error: {replay.error_message}\")\n            \nexcept Exception as e:\n    print(f\"MCP tool error: {e}\")\n```\n\n## Safety and Legal Considerations\n\n- **Frequency Regulations**: Check local laws before transmission\n- **Power Limits**: Adhere to maximum EIRP limits\n- **Interference**: Avoid interfering with licensed services\n- **Privacy**: Respect wireless communications privacy\n- **Antenna Safety**: Use appropriate antennas for frequencies\n\n## Advanced Techniques\n\n### Signal Analysis\n```python\n# Use RAW modulation for signal analysis\nraw_capture = start_rf_capture(\n    frequency={{analysis_frequency}},\n    modulation=\"RAW\",\n    sample_rate=2000000,  # 2Msps for detailed analysis\n    duration_ms=5000\n)\n\n# Analyze captured raw data for protocol reverse engineering\n# Look for patterns, bit sequences, timing information\n```\n\n### Protocol Learning\n```python\n# Capture multiple transmissions to learn protocol\nlearning_frames = []\nfor i in range(10):  # Capture 10 button presses\n    capture = start_rf_capture(\n        frequency=433920000,\n        modulation=\"OOK\",\n        duration_ms=1000  # Short capture per press\n    )\n    if capture.frames:\n        learning_frames.extend(capture.frames)\n\n# Analyze patterns across multiple captures\n# Identify preamble, sync bits, data payload, checksums\n```\n\nUse this pattern to ensure reliable RF signal capture and replay through the MIA NucleusESP32 MCP interface.",
  "variables": [
    "rf_frequency",
    "rf_modulation",
    "capture_duration",
    "rf_frame_data",
    "center_frequency",
    "detected_frequency",
    "detected_modulation",
    "analysis_frequency"
  ],
  "tags": ["hardware", "rf", "capture", "replay", "nucleus", "esp32", "mcp", "mia"],
  "author": "MIA System",
  "version": "2.0.0"
}